<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.car.mapper.user.UserMapper">
  <resultMap id="BaseResultMap" type="com.car.entity.user.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    <id column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="user_pwd" jdbcType="VARCHAR" property="userPwd" />
    <result column="real_name" jdbcType="VARCHAR" property="realName" />
    <result column="user_sex" jdbcType="INTEGER" property="userSex" />
    <result column="user_idcard" jdbcType="VARCHAR" property="userIdcard" />
    <result column="user_emails" jdbcType="VARCHAR" property="userEmails" />
    <result column="user_tel" jdbcType="VARCHAR" property="userTel" />
    <result column="user_img" jdbcType="VARCHAR" property="userImg" />
    <result column="user_birthday" jdbcType="DATE" property="userBirthday" />
    <result column="user_status" jdbcType="INTEGER" property="userStatus" />
    <result column="user_create_time" jdbcType="DATE" property="userCreateTime" />
    <result column="user_login_time" jdbcType="DATE" property="userLoginTime" />
    <result column="user_level_num" jdbcType="INTEGER" property="userLevelNum" />
    <result column="user_login_num" jdbcType="INTEGER" property="userLoginNum" />
    <result column="coupon_name" jdbcType="VARCHAR" property="couponName" />
    <result column="coupon_content" jdbcType="VARCHAR" property="couponContent" />
    <result column="coupon_money" jdbcType="VARCHAR" property="couponMoney" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    user_id, user_name, user_pwd, real_name, user_sex, user_idcard, user_emails, user_tel, 
    user_img, user_birthday, user_status, user_create_time, user_login_time, user_level_num, 
    user_login_num, coupon_name, coupon_content, coupon_money
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from buyer_user
    where user_id = #{userId,jdbcType=INTEGER}
  </select>
  
  <select id="getAllUserLists" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    SELECT b.real_name, b.user_pwd, b.user_name, b.user_id, cou.coupon_name,cou.coupon_money,cou.coupon_content
	FROM buyer_user b LEFT JOIN buyer_user_coupon_rel bucr ON bucr.user_id = b.user_id
	LEFT JOIN coupon cou ON cou.coupon_id = bucr.coupon_id
	WHERE b.user_id = #{userId,jdbcType=INTEGER}
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    delete from buyer_user
    where user_id = #{userId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.car.entity.user.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    insert into buyer_user (user_id, user_name, user_pwd, 
      real_name, user_sex, user_idcard, 
      user_emails, user_tel, user_img, 
      user_birthday, user_status, user_create_time, 
      user_login_time, user_level_num, user_login_num
      )
    values (#{userId,jdbcType=INTEGER}, #{userName,jdbcType=VARCHAR}, #{userPwd,jdbcType=VARCHAR}, 
      #{realName,jdbcType=VARCHAR}, #{userSex,jdbcType=INTEGER}, #{userIdcard,jdbcType=VARCHAR}, 
      #{userEmails,jdbcType=VARCHAR}, #{userTel,jdbcType=VARCHAR}, #{userImg,jdbcType=VARCHAR}, 
      #{userBirthday,jdbcType=DATE}, #{userStatus,jdbcType=INTEGER}, #{userCreateTime,jdbcType=DATE}, 
      #{userLoginTime,jdbcType=DATE}, #{userLevelNum,jdbcType=INTEGER}, #{userLoginNum,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.car.entity.user.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    insert into buyer_user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        user_id,
      </if>
      <if test="userName != null">
        user_name,
      </if>
      <if test="userPwd != null">
        user_pwd,
      </if>
      <if test="realName != null">
        real_name,
      </if>
      <if test="userSex != null">
        user_sex,
      </if>
      <if test="userIdcard != null">
        user_idcard,
      </if>
      <if test="userEmails != null">
        user_emails,
      </if>
      <if test="userTel != null">
        user_tel,
      </if>
      <if test="userImg != null">
        user_img,
      </if>
      <if test="userBirthday != null">
        user_birthday,
      </if>
      <if test="userStatus != null">
        user_status,
      </if>
      <if test="userCreateTime != null">
        user_create_time,
      </if>
      <if test="userLoginTime != null">
        user_login_time,
      </if>
      <if test="userLevelNum != null">
        user_level_num,
      </if>
      <if test="userLoginNum != null">
        user_login_num,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        #{userId,jdbcType=INTEGER},
      </if>
      <if test="userName != null">
        #{userName,jdbcType=VARCHAR},
      </if>
      <if test="userPwd != null">
        #{userPwd,jdbcType=VARCHAR},
      </if>
      <if test="realName != null">
        #{realName,jdbcType=VARCHAR},
      </if>
      <if test="userSex != null">
        #{userSex,jdbcType=INTEGER},
      </if>
      <if test="userIdcard != null">
        #{userIdcard,jdbcType=VARCHAR},
      </if>
      <if test="userEmails != null">
        #{userEmails,jdbcType=VARCHAR},
      </if>
      <if test="userTel != null">
        #{userTel,jdbcType=VARCHAR},
      </if>
      <if test="userImg != null">
        #{userImg,jdbcType=VARCHAR},
      </if>
      <if test="userBirthday != null">
        #{userBirthday,jdbcType=DATE},
      </if>
      <if test="userStatus != null">
        #{userStatus,jdbcType=INTEGER},
      </if>
      <if test="userCreateTime != null">
        #{userCreateTime,jdbcType=DATE},
      </if>
      <if test="userLoginTime != null">
        #{userLoginTime,jdbcType=DATE},
      </if>
      <if test="userLevelNum != null">
        #{userLevelNum,jdbcType=INTEGER},
      </if>
      <if test="userLoginNum != null">
        #{userLoginNum,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.car.entity.user.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    update buyer_user
    <set>
      <if test="userName != null">
        user_name = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="userPwd != null">
        user_pwd = #{userPwd,jdbcType=VARCHAR},
      </if>
      <if test="realName != null">
        real_name = #{realName,jdbcType=VARCHAR},
      </if>
      <if test="userSex != null">
        user_sex = #{userSex,jdbcType=INTEGER},
      </if>
      <if test="userIdcard != null">
        user_idcard = #{userIdcard,jdbcType=VARCHAR},
      </if>
      <if test="userEmails != null">
        user_emails = #{userEmails,jdbcType=VARCHAR},
      </if>
      <if test="userTel != null">
        user_tel = #{userTel,jdbcType=VARCHAR},
      </if>
      <if test="userImg != null">
        user_img = #{userImg,jdbcType=VARCHAR},
      </if>
      <if test="userBirthday != null">
        user_birthday = #{userBirthday,jdbcType=DATE},
      </if>
      <if test="userStatus != null">
        user_status = #{userStatus,jdbcType=INTEGER},
      </if>
      <if test="userCreateTime != null">
        user_create_time = #{userCreateTime,jdbcType=DATE},
      </if>
      <if test="userLoginTime != null">
        user_login_time = #{userLoginTime,jdbcType=DATE},
      </if>
      <if test="userLevelNum != null">
        user_level_num = #{userLevelNum,jdbcType=INTEGER},
      </if>
      <if test="userLoginNum != null">
        user_login_num = #{userLoginNum,jdbcType=INTEGER},
      </if>
    </set>
    where user_id = #{userId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.car.entity.user.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 21 08:49:17 CST 2018.
    -->
    update buyer_user
    set user_name = #{userName,jdbcType=VARCHAR},
      user_pwd = #{userPwd,jdbcType=VARCHAR},
      real_name = #{realName,jdbcType=VARCHAR},
      user_sex = #{userSex,jdbcType=INTEGER},
      user_idcard = #{userIdcard,jdbcType=VARCHAR},
      user_emails = #{userEmails,jdbcType=VARCHAR},
      user_tel = #{userTel,jdbcType=VARCHAR},
      user_img = #{userImg,jdbcType=VARCHAR},
      user_birthday = #{userBirthday,jdbcType=DATE},
      user_status = #{userStatus,jdbcType=INTEGER},
      user_create_time = #{userCreateTime,jdbcType=DATE},
      user_login_time = #{userLoginTime,jdbcType=DATE},
      user_level_num = #{userLevelNum,jdbcType=INTEGER},
      user_login_num = #{userLoginNum,jdbcType=INTEGER}
    where user_id = #{userId,jdbcType=INTEGER}
  </update>
  
  
  <!--gtw 根据用户名密码查询 -->
   <select id="loginn" parameterType="com.car.entity.user.User" resultMap="BaseResultMap">
    select 
     user_id as userId,
     user_name,
     user_pwd,
     user_login_time,
     user_login_num,
     real_name
    from buyer_user
    where user_name = #{userName} and user_pwd=#{userPwd}
  </select>
  
  <!--ht 根据用户名查询 -->
   <select id="getUserByUsername" parameterType="com.car.entity.user.User" resultType="com.car.entity.user.User">
    select 
     user_id as userId,
     user_name as userName,
     user_pwd as userPwd,
     user_login_time,
     user_login_num,
     real_name as realName
    from buyer_user
    where user_name = #{userName}
  </select>
  <!--gtw 查询登陆次数 -->
    <update id="updateNumByUid" parameterType="java.lang.Integer">
  	update buyer_user
  	set userLoginNum = 0
  	where user_id = #{userId}
  </update>
  <!--gtw 修改登陆时间 -->
   <update id="updateDateTimeSelectiveByUid" parameterType="com.car.entity.user.User">
  	update buyer_user
  	set user_login_num=#{userLoginNum},
  	user_login_time=#{serLoginTime}
  	where user_id = #{userId}
  </update>
  <!-- gtw -->
    <update id="updateLoginNumByUid" parameterType="com.car.entity.user.User">
  	update buyer_user
  	set user_login_num = userLoginNum+1
  	where user_id = #{userId}
  </update>
  
  <!--gtw  -->
  <select id="getAllUserList" resultMap="BaseResultMap">
  	select *	from buyer_user
  </select>
  <!-- ht -->
  <update id="blockUser" parameterType="java.lang.Integer">
    
    update buyer_user
    set 
      user_status = 2
      
    where user_id = #{userId,jdbcType=INTEGER}
  </update>
  
 
  
  
    
  
  
  <select id="selectUser" resultMap="BaseResultMap"  parameterType="com.car.entity.user.User">
  select 
     user_id, user_name, user_pwd, real_name, user_sex, user_idcard, user_emails, user_tel, 
    user_img, user_birthday, user_status, user_create_time, user_login_time, user_level_num, 
    user_login_num
   from buyer_user where user_id = #{userId};
  </select>
  
  <select id="selectPwd" resultType="com.car.entity.user.User" parameterType="com.car.entity.user.User">
  
select  user_id as userId,user_pwd from buyer_user where  user_name = #{userName} and user_pwd=#{userPwd};
  </select>
  

  
  <update id=" updatePwd"  parameterType="com.car.entity.user.User">
  update buyer_user
  	set  user_pwd=#{userPwd}
  	where user_id = #{userId};
  </update>
  <select id="selSameUser" parameterType="com.car.entity.user.User" resultMap="BaseResultMap">
  		select * from buyer_user where user_name = #{userName}
  </select>
  

   <update id="updateByUser" parameterType="com.car.entity.user.User">

    update buyer_user
    set 
      real_name = #{realName,jdbcType=VARCHAR},
      user_sex = #{userSex,jdbcType=INTEGER},
      user_idcard = #{userIdcard,jdbcType=VARCHAR},
      user_emails = #{userEmails,jdbcType=VARCHAR},
      user_tel = #{userTel,jdbcType=VARCHAR},
      user_img = #{userImg,jdbcType=VARCHAR},
      user_birthday = #{userBirthday,jdbcType=DATE},
      user_level_num = #{userLevelNum,jdbcType=INTEGER}
   
    where user_id = #{userId,jdbcType=INTEGER}
  </update>
  

  
</mapper>