<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.car.mapper.car.CarGoodsMapper" >
  <resultMap id="BaseResultMap" type="com.car.entity.car.CarGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    <id column="car_id" property="carId" jdbcType="INTEGER" />
    <result column="car_name" property="carName" jdbcType="VARCHAR" />
    <result column="car_price" property="carPrice" jdbcType="INTEGER" />
    <result column="car_oilwear" property="carOilwear" jdbcType="VARCHAR" />
    <result column="configuration" property="configuration" jdbcType="INTEGER" />
    <result column="car_cc" property="carCc" jdbcType="DOUBLE" />
    <result column="car_speed" property="carSpeed" jdbcType="INTEGER" />
    <result column="car_status" property="carStatus" jdbcType="INTEGER" />
    <result column="car_safety" property="carSafety" jdbcType="INTEGER" />
    <result column="car_datea" property="carDatea" jdbcType="DATE" />
    <result column="car_warranty" property="carWarranty" jdbcType="INTEGER" />
    <result column="car_heat" property="carHeat" jdbcType="INTEGER" />
    <result column="car_col_num" property="carColNum" jdbcType="INTEGER" />
    <result column="car_img" property="carImg" jdbcType="VARCHAR" />
    <result column="brand_id" property="brandId" jdbcType="INTEGER" />
    <result column="brand_name" property="brandName" jdbcType="VARCHAR" />
    <result column="model_id" property="modelId" jdbcType="INTEGER" />
    <result column="model_name" property="modelName" jdbcType="VARCHAR" />
    <result column="rep_id" property="repId" jdbcType="INTEGER" />
	<result column="rep_name" property="repName" jdbcType="VARCHAR" />
    <result column="pid" property="pid" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    car_id, car_name, car_price, car_oilwear, configuration, car_cc, car_speed, car_status, 
    car_safety, car_datea, car_warranty, car_heat, car_col_num, car_img
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    select 
    car_id, car_name, car_price, car_oilwear, configuration, car_cc, car_speed, car_status, 
	    car_safety, car_datea, car_warranty, car_heat, car_col_num, car_img
    from car_goods
    where car_id = #{carId,jdbcType=INTEGER}
  </select>
  <select id="getGoodsList" resultMap="BaseResultMap" parameterType="map" >
  		SELECT 
			g.*, b.brand_name, m.model_name ,r.rep_name
		FROM 
			car_goods g
		LEFT JOIN 
			car_brand_model_rel bmr 
				ON bmr.car_id=g.car_id
		LEFT JOIN 
			car_brand b 
				ON b.brand_id = bmr.brand_id
		LEFT JOIN 
			car_model m 
				ON m.model_id =bmr.model_id
		LEFT JOIN 
			car_rep_rel crr 
				ON crr.car_id = g.car_id
		LEFT JOIN 
			car_repository r 
				ON r.rep_id = crr.rep_id
	 <where>
		 <if test="brandId !=null">
		 bmr.brand_id = #{brandId}
		 </if>
		 <if test="modelId !=null">
		 and bmr.model_id = #{modelId}
		 </if>
		 <if test="priceId !=null">
		 and g.car_price  ${priceId}
		 </if>
		 <if test="carName !=null">
		 and g.car_name like'%${carName}%'  
		 </if>
	</where>
		order by g.car_heat desc
  </select>
 
  <select id="getGoods" resultMap="BaseResultMap">
  		 select  <include refid="Base_Column_List"></include> 
       from car_goods
       order by car_heat desc
  </select>
  
  <select id="getGoodsLists" resultMap="BaseResultMap">
  	   select  <include refid="Base_Column_List"></include> 
       from car_goods where car_name like '%${carName}%'
       order by car_heat desc
  </select>
  <select id="getCount" resultType="INTEGER" parameterType="com.car.entity.car.CarGoods" >
       select count(*)
    from car_goods  
      
  </select>
  <select id="getGoodsBuyIds" resultMap="BaseResultMap" parameterType="map">
	SELECT 
		g.*, b.brand_name, m.model_name ,r.rep_name
	FROM 
		car_goods g
	LEFT JOIN 
		car_brand_model_rel bmr 
			ON bmr.car_id=g.car_id
	LEFT JOIN 
		car_brand b 
			ON b.brand_id = bmr.brand_id
	LEFT JOIN 
		car_model m 
			ON m.model_id =bmr.model_id
	LEFT JOIN 
		car_color_rel cr 
			ON cr.goods_id = g.car_id
	LEFT JOIN 
		car_color cc 
			ON cc.color_id = cr.color_id
	LEFT JOIN 
		car_rep_rel crr 
			ON crr.car_id = g.car_id
	LEFT JOIN 
		car_repository r 
			ON r.rep_id = crr.rep_id
	 <where>
		 <if test="brandId !='null'">
		 bmr.brand_id = #{brandId}
		 </if>
		 <if test="modelId !='null'">
		 and bmr.model_id = #{modelId}
		 </if>
		 <if test="priceId !='null'">
		 and g.car_price  ${priceId}
		 </if>
		 <if test="statusId !='null'">
		 and g.car_status = #{statusId}
		 </if>
		 <if test="colorId !='null'">
		 and cr.color_id = #{colorId}
		 </if>
		 <if test="onfigId !='null'">
		 and g.configuration = #{onfigId}
		 </if>
		 <if test="ccId !='null'">
		 and g.car_cc ${ccId}
		 </if>
		 <if test="speedId !='null'">
		 and g.car_speed ${speedId}
		 </if>
		 <if test="safeId !='null'">
		 and g.car_safety = #{safeId}
		 </if>
	</where>
		order by ${pxName}
  </select>
    <select id="getGoodsNum" resultMap="BaseResultMap" parameterType="map">
    SELECT count(1) FROM car_goods g
	LEFT JOIN car_brand_model_rel bmr ON bmr.car_id=g.car_id
	LEFT JOIN car_brand b ON b.brand_id = bmr.brand_id
	LEFT JOIN car_model m ON m.model_id =bmr.model_id
	 <where>
		 <if test="brandId!='null'">
		 bmr.brand_id = #{brandId}
		 </if>
		 <if test="modelId!='null'">
		 and bmr.model_id = #{modelId}
		 </if>
		 <if test="priceId!='null'">
		 and g.car_price ${priceId}
		 </if>
	</where>
		 and 1=1
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    delete from car_goods
    where car_id = #{carId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.car.entity.car.CarGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    insert into car_goods (car_id, car_name, car_price, 
      car_oilwear, configuration, car_cc, 
      car_speed, car_status, car_safety, 
      car_datea, car_warranty, car_heat, 
      car_col_num, car_img)
    values (#{carId,jdbcType=INTEGER}, #{carName,jdbcType=VARCHAR}, #{carPrice,jdbcType=INTEGER}, 
      #{carOilwear,jdbcType=VARCHAR}, #{configuration,jdbcType=INTEGER}, #{carCc,jdbcType=DOUBLE}, 
      #{carSpeed,jdbcType=INTEGER}, #{carStatus,jdbcType=INTEGER}, #{carSafety,jdbcType=INTEGER}, 
      #{carDatea,jdbcType=DATE}, #{carWarranty,jdbcType=INTEGER}, #{carHeat,jdbcType=INTEGER}, 
      #{carColNum,jdbcType=INTEGER}, #{carImg,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.car.entity.car.CarGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    insert into car_goods
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="carId != null" >
        car_id,
      </if>
      <if test="carName != null" >
        car_name,
      </if>
      <if test="carPrice != null" >
        car_price,
      </if>
      <if test="carOilwear != null" >
        car_oilwear,
      </if>
      <if test="configuration != null" >
        configuration,
      </if>
      <if test="carCc != null" >
        car_cc,
      </if>
      <if test="carSpeed != null" >
        car_speed,
      </if>
      <if test="carStatus != null" >
        car_status,
      </if>
      <if test="carSafety != null" >
        car_safety,
      </if>
      <if test="carDatea != null" >
        car_datea,
      </if>
      <if test="carWarranty != null" >
        car_warranty,
      </if>
      <if test="carHeat != null" >
        car_heat,
      </if>
      <if test="carColNum != null" >
        car_col_num,
      </if>
      <if test="carImg != null" >
        car_img,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="carId != null" >
        #{carId,jdbcType=INTEGER},
      </if>
      <if test="carName != null" >
        #{carName,jdbcType=VARCHAR},
      </if>
      <if test="carPrice != null" >
        #{carPrice,jdbcType=INTEGER},
      </if>
      <if test="carOilwear != null" >
        #{carOilwear,jdbcType=VARCHAR},
      </if>
      <if test="configuration != null" >
        #{configuration,jdbcType=INTEGER},
      </if>
      <if test="carCc != null" >
        #{carCc,jdbcType=DOUBLE},
      </if>
      <if test="carSpeed != null" >
        #{carSpeed,jdbcType=INTEGER},
      </if>
      <if test="carStatus != null" >
        #{carStatus,jdbcType=INTEGER},
      </if>
      <if test="carSafety != null" >
        #{carSafety,jdbcType=INTEGER},
      </if>
      <if test="carDatea != null" >
        #{carDatea,jdbcType=DATE},
      </if>
      <if test="carWarranty != null" >
        #{carWarranty,jdbcType=INTEGER},
      </if>
      <if test="carHeat != null" >
        #{carHeat,jdbcType=INTEGER},
      </if>
      <if test="carColNum != null" >
        #{carColNum,jdbcType=INTEGER},
      </if>
      <if test="carImg != null" >
        #{carImg,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.car.entity.car.CarGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    update car_goods
    <set >
      <if test="carName != null" >
        car_name = #{carName,jdbcType=VARCHAR},
      </if>
      <if test="carPrice != null" >
        car_price = #{carPrice,jdbcType=INTEGER},
      </if>
      <if test="carOilwear != null" >
        car_oilwear = #{carOilwear,jdbcType=VARCHAR},
      </if>
      <if test="configuration != null" >
        configuration = #{configuration,jdbcType=INTEGER},
      </if>
      <if test="carCc != null" >
        car_cc = #{carCc,jdbcType=DOUBLE},
      </if>
      <if test="carSpeed != null" >
        car_speed = #{carSpeed,jdbcType=INTEGER},
      </if>
      <if test="carStatus != null" >
        car_status = #{carStatus,jdbcType=INTEGER},
      </if>
      <if test="carSafety != null" >
        car_safety = #{carSafety,jdbcType=INTEGER},
      </if>
      <if test="carDatea != null" >
        car_datea = #{carDatea,jdbcType=DATE},
      </if>
      <if test="carWarranty != null" >
        car_warranty = #{carWarranty,jdbcType=INTEGER},
      </if>
      <if test="carHeat != null" >
        car_heat = #{carHeat,jdbcType=INTEGER},
      </if>
      <if test="carColNum != null" >
        car_col_num = #{carColNum,jdbcType=INTEGER},
      </if>
      <if test="carImg != null" >
        car_img = #{carImg,jdbcType=VARCHAR},
      </if>
    </set>
    where car_id = #{carId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.car.entity.car.CarGoods" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 14:20:53 CST 2018.
    -->
    <!-- ht 删除于2018-4-20 10:18:13
    car_heat = #{carHeat,jdbcType=INTEGER},
      car_col_num = #{carColNum,jdbcType=INTEGER},
     -->
    update car_goods
    set car_name = #{carName,jdbcType=VARCHAR},
      car_price = #{carPrice,jdbcType=INTEGER},
      car_oilwear = #{carOilwear,jdbcType=VARCHAR},
      configuration = #{configuration,jdbcType=INTEGER},
      car_cc = #{carCc,jdbcType=DOUBLE},
      car_speed = #{carSpeed,jdbcType=INTEGER},
      car_status = #{carStatus,jdbcType=INTEGER},
      car_safety = #{carSafety,jdbcType=INTEGER},
      car_datea = #{carDatea,jdbcType=DATE},
      car_warranty = #{carWarranty,jdbcType=INTEGER},
      
      car_img = #{carImg,jdbcType=VARCHAR}
    where car_id = #{carId,jdbcType=INTEGER}
  </update>
  <!-- ht -->
  <select id="findcarList" resultMap="BaseResultMap">
    select 
	    car_id, car_name, car_price, car_oilwear, configuration, car_cc, car_speed, car_status, 
	    car_safety, car_datea, car_warranty, car_heat, car_col_num, car_img
    from 
    	car_goods
   
  </select>
  
  
  <update id="mainCarImgUpdate" parameterType="com.car.entity.car.CarGoods" >

    update car_goods
    set 
      car_img = #{carImg,jdbcType=VARCHAR}
    where car_id = #{carId,jdbcType=INTEGER}
  </update>
  <update id="insertCollect" parameterType="java.lang.Integer">
  	update car_goods set car_col_num = car_col_num+1 where car_id = #{carId}
  </update>
  <update id="delCollect" parameterType="java.lang.Integer">
  	update car_goods set car_col_num = car_col_num-1 where car_id = #{carId}
  </update>
  <select id="findCarId" resultMap="BaseResultMap">
    select 
	    car_id, car_name
    from 
    	car_goods
   
  </select>
  <!-- ht 轮播图片关联的汽车 -->
   <select id="selectCarNameByCarId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
  
    select 
    car_id, car_name
    from car_goods
    where car_id = #{carId,jdbcType=INTEGER}
  </select>
  <!-- 查询收藏 -->
  <select id="selectCollect" resultMap="BaseResultMap" parameterType="com.car.entity.car.CarGoods">
  select * from car_goods inner join user_collect on car_goods.car_id = user_collect.car_id inner join  buyer_user on buyer_user.user_id = user_collect.user_id where buyer_user.user_id=#{userId};
  </select>
  <select id="getCarsByIds" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select <include refid="Base_Column_List"></include>
  	from car_goods 
  	where car_id in (${_parameter})
  </select>
  <insert id="insertAll" parameterType="java.util.List">
  		insert into car_goods
        (car_name, car_price, car_oilwear, configuration, car_cc, car_speed, car_status, 
    car_safety, car_datea, car_warranty, car_heat, car_col_num, car_img)
        values
        <foreach collection="list" item="c" index="index"
            separator=",">
            (
            #{c.carName},#{c.carPrice},#{c.carOilwear},#{c.configuration},
            #{c.carCc},#{c.carSpeed},#{c.carStatus},#{c.carSafety},
            #{c.carDatea},#{c.carWarranty},#{c.carHeat},#{c.carColNum},#{c.carImg}
            )
        </foreach>
  </insert>
</mapper>