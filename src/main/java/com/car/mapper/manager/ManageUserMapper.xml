<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.car.mapper.manager.ManageUserMapper">
  <resultMap id="BaseResultMap" type="com.car.entity.manager.ManageUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    <id column="manage_id" jdbcType="INTEGER" property="manageId" />
    <result column="login_name" jdbcType="VARCHAR" property="loginName" />
    <result column="login_pwd" jdbcType="VARCHAR" property="loginPwd" />
    <result column="manage_name" jdbcType="VARCHAR" property="manageName" />
    <result column="manage_sex" jdbcType="INTEGER" property="manageSex" />
    <result column="manage_idcard" jdbcType="VARCHAR" property="manageIdcard" />
    <result column="manage_emails" jdbcType="VARCHAR" property="manageEmails" />
    <result column="manage_tel" jdbcType="VARCHAR" property="manageTel" />
    <result column="manage_img" jdbcType="VARCHAR" property="manageImg" />
    <result column="manage_status" jdbcType="INTEGER" property="manageStatus" />
    <result column="manage_birthday" jdbcType="VARCHAR" property="manageBirthday" />
    <result column="login_lasttime" jdbcType="DATE" property="loginLasttime" />
    <result column="login_num" jdbcType="INTEGER" property="loginNum" />
    <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    <result column="login_time" jdbcType="VARCHAR" property="loginTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    manage_id, login_name, login_pwd, manage_name, manage_sex, manage_idcard, manage_emails, 
    manage_tel, manage_img, manage_status, manage_birthday, login_lasttime, login_num, 
    create_time, login_time
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from manage_user
    where manage_id = #{manageId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    delete from manage_user
    where manage_id = #{manageId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.car.entity.manager.ManageUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
     <selectKey resultType="int" keyProperty="manageId" order="AFTER">
    	select LAST_INSERT_ID() as manageId
    </selectKey>
    insert into manage_user (manage_id, login_name, login_pwd, 
      manage_name, manage_sex, manage_idcard, 
      manage_emails, manage_tel, manage_img, 
      manage_status, manage_birthday, login_lasttime, 
      login_num, create_time, login_time
      )
    values (#{manageId,jdbcType=INTEGER}, #{loginName,jdbcType=VARCHAR}, #{loginPwd,jdbcType=VARCHAR}, 
      #{manageName,jdbcType=VARCHAR}, #{manageSex,jdbcType=INTEGER}, #{manageIdcard,jdbcType=VARCHAR}, 
      #{manageEmails,jdbcType=VARCHAR}, #{manageTel,jdbcType=VARCHAR}, #{manageImg,jdbcType=VARCHAR}, 
      #{manageStatus,jdbcType=INTEGER}, #{manageBirthday,jdbcType=VARCHAR}, #{loginLasttime,jdbcType=DATE}, 
      #{loginNum,jdbcType=INTEGER}, #{createTime,jdbcType=VARCHAR}, #{loginTime,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.car.entity.manager.ManageUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    insert into manage_user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="manageId != null">
        manage_id,
      </if>
      <if test="loginName != null">
        login_name,
      </if>
      <if test="loginPwd != null">
        login_pwd,
      </if>
      <if test="manageName != null">
        manage_name,
      </if>
      <if test="manageSex != null">
        manage_sex,
      </if>
      <if test="manageIdcard != null">
        manage_idcard,
      </if>
      <if test="manageEmails != null">
        manage_emails,
      </if>
      <if test="manageTel != null">
        manage_tel,
      </if>
      <if test="manageImg != null">
        manage_img,
      </if>
      <if test="manageStatus != null">
        manage_status,
      </if>
      <if test="manageBirthday != null">
        manage_birthday,
      </if>
      <if test="loginLasttime != null">
        login_lasttime,
      </if>
      <if test="loginNum != null">
        login_num,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="loginTime != null">
        login_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="manageId != null">
        #{manageId,jdbcType=INTEGER},
      </if>
      <if test="loginName != null">
        #{loginName,jdbcType=VARCHAR},
      </if>
      <if test="loginPwd != null">
        #{loginPwd,jdbcType=VARCHAR},
      </if>
      <if test="manageName != null">
        #{manageName,jdbcType=VARCHAR},
      </if>
      <if test="manageSex != null">
        #{manageSex,jdbcType=INTEGER},
      </if>
      <if test="manageIdcard != null">
        #{manageIdcard,jdbcType=VARCHAR},
      </if>
      <if test="manageEmails != null">
        #{manageEmails,jdbcType=VARCHAR},
      </if>
      <if test="manageTel != null">
        #{manageTel,jdbcType=VARCHAR},
      </if>
      <if test="manageImg != null">
        #{manageImg,jdbcType=VARCHAR},
      </if>
      <if test="manageStatus != null">
        #{manageStatus,jdbcType=INTEGER},
      </if>
      <if test="manageBirthday != null">
        #{manageBirthday,jdbcType=VARCHAR},
      </if>
      <if test="loginLasttime != null">
        #{loginLasttime,jdbcType=DATE},
      </if>
      <if test="loginNum != null">
        #{loginNum,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="loginTime != null">
        #{loginTime,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.car.entity.manager.ManageUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    update manage_user
    <set>
      <if test="loginName != null">
        login_name = #{loginName,jdbcType=VARCHAR},
      </if>
      <if test="loginPwd != null">
        login_pwd = #{loginPwd,jdbcType=VARCHAR},
      </if>
      <if test="manageName != null">
        manage_name = #{manageName,jdbcType=VARCHAR},
      </if>
      <if test="manageSex != null">
        manage_sex = #{manageSex,jdbcType=INTEGER},
      </if>
      <if test="manageIdcard != null">
        manage_idcard = #{manageIdcard,jdbcType=VARCHAR},
      </if>
      <if test="manageEmails != null">
        manage_emails = #{manageEmails,jdbcType=VARCHAR},
      </if>
      <if test="manageTel != null">
        manage_tel = #{manageTel,jdbcType=VARCHAR},
      </if>
      <if test="manageImg != null">
        manage_img = #{manageImg,jdbcType=VARCHAR},
      </if>
      <if test="manageStatus != null">
        manage_status = #{manageStatus,jdbcType=INTEGER},
      </if>
      <if test="manageBirthday != null">
        manage_birthday = #{manageBirthday,jdbcType=VARCHAR},
      </if>
      <if test="loginLasttime != null">
        login_lasttime = #{loginLasttime,jdbcType=DATE},
      </if>
      <if test="loginNum != null">
        login_num = #{loginNum,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="loginTime != null">
        login_time = #{loginTime,jdbcType=VARCHAR},
      </if>
    </set>
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.car.entity.manager.ManageUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 26 21:27:51 CST 2018.
    -->
    update manage_user
    set login_name = #{loginName,jdbcType=VARCHAR},
      login_pwd = #{loginPwd,jdbcType=VARCHAR},
      manage_name = #{manageName,jdbcType=VARCHAR},
      manage_sex = #{manageSex,jdbcType=INTEGER},
      manage_idcard = #{manageIdcard,jdbcType=VARCHAR},
      manage_emails = #{manageEmails,jdbcType=VARCHAR},
      manage_tel = #{manageTel,jdbcType=VARCHAR},
      manage_img = #{manageImg,jdbcType=VARCHAR},
      manage_status = #{manageStatus,jdbcType=INTEGER},
      manage_birthday = #{manageBirthday,jdbcType=VARCHAR},
      login_lasttime = #{loginLasttime,jdbcType=DATE},
      login_num = #{loginNum,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=VARCHAR},
      login_time = #{loginTime,jdbcType=VARCHAR}
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
 

  <insert id="insertt" parameterType="com.car.entity.manager.ManageUser">
    insert 
    	into manage_user(login_name,login_pwd) 
    values
    	(#{loginName},#{loginPwd});
  </insert>
  
  
  
  <!-- ��¼ -->
 <select id="login" parameterType="com.car.entity.manager.ManageUser" resultMap="BaseResultMap">
  select * from manage_user where login_name=#{loginName} and login_pwd=#{loginPwd}
  </select>
  
  
  
   <resultMap id="BaseResultMap2" type="com.car.entity.manager.ManageUser">
    <id column="manage_id" jdbcType="INTEGER" property="manageId" />
    <result column="login_name" jdbcType="VARCHAR" property="loginName" />
    <result column="login_pwd" jdbcType="VARCHAR" property="loginPwd" />
    <result column="manage_name" jdbcType="VARCHAR" property="manageName" />
    <result column="manage_sex" jdbcType="INTEGER" property="manageSex" />
    <result column="manage_idcard" jdbcType="VARCHAR" property="manageIdcard" />
    <result column="manage_emails" jdbcType="VARCHAR" property="manageEmails" />
    <result column="manage_tel" jdbcType="VARCHAR" property="manageTel" />
    <result column="manage_img" jdbcType="VARCHAR" property="manageImg" />
    <result column="manage_status" jdbcType="INTEGER" property="manageStatus" />
    <result column="manage_birthday" jdbcType="DATE" property="manageBirthday" />
    <result column="login_lasttime" jdbcType="DATE" property="loginLasttime" />
    <result column="login_num" jdbcType="INTEGER" property="loginNum" />
    <result column="create_time" jdbcType="DATE" property="createTime" />
    <result column="login_time" jdbcType="DATE" property="loginTime" />
    <result column="role_id" jdbcType="INTEGER" property="roleId" />
    <result column="role_name" jdbcType="VARCHAR" property="roleName" />
  </resultMap>
    <sql id="Base_2">
    m.manage_id, m.login_name, m.login_pwd, m.manage_name, m.manage_sex, m.manage_idcard, m.manage_emails, 
    m.manage_tel, m.manage_img, m.manage_status, m.manage_birthday, m.login_lasttime, m.login_num, 
    m.create_time, m.login_time ,r.role_id ,r.role_name
  </sql>
   <select id="findManageUserList" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from manage_user 
   
  </select>
   <update id="updateLoginPwdInit" parameterType="com.car.entity.manager.ManageUser">
    update manage_user
    set 
      login_pwd = #{loginPwd,jdbcType=VARCHAR}
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
     <select id="finduserbyrid" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    select 
    <include refid="Base_2" />
    from manage_user m,manage_role r,manage_user_role mr 
    where m.manage_id=mr.manage_id and r.role_id = mr.role_id
    and r.role_id=#{roleId}
  </select>
  <update id="stopManageUser" parameterType="java.lang.Integer">
 
    update manage_user
    set 
      manage_status = 2
      
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
  <update id="enableManageUser" parameterType="java.lang.Integer">
 
    update manage_user
    set 
      manage_status = 1
      
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
    <select id="getUserByUsername" parameterType="com.car.entity.manager.ManageUser" resultMap="BaseResultMap">

    select 
    <include refid="Base_Column_List" />
    from manage_user
    where login_name = #{loginName}
  </select>
  
    <update id="updateNumByManageId" parameterType="int">

    update manage_user
    set 
      login_num = 0
     
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
    <update id="updateDateTimeSelectiveByUid" parameterType="com.car.entity.manager.ManageUser">
    update manage_user
    set 
      login_num = #{loginNum,jdbcType=INTEGER},
      login_time = #{loginTime,jdbcType=VARCHAR}
    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
  <update id="updateLoginNumByUid" parameterType="com.car.entity.manager.ManageUser">
    update manage_user
    set 
      login_num = login_num + 1

    where manage_id = #{manageId,jdbcType=INTEGER}
  </update>
</mapper>